<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Universal Demand Forecasting Tool</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    body { background:#0b1120; margin:0; color:#e5e7eb; font-family:system-ui }
    .page { padding:20px; max-width:1200px; margin:0 auto }
    .toggle-container { display:flex; justify-content:flex-end; gap:8px; margin-bottom:10px }
    .toggle-button {
      padding:6px 14px; border-radius:20px; border:1px solid #38bdf8;
      background:none; color:#38bdf8; cursor:pointer; font-size:14px
    }
    .toggle-button.active { background:#38bdf8; color:#0b1120; font-weight:600 }
    .hidden { display:none }
    table { width:100%; border-collapse:collapse; margin-top:10px; font-size:14px }
    th, td { border-bottom:1px solid #1f2937; padding:6px }
    th { color:#9ca3af; text-transform:uppercase; font-size:12px; text-align:left }
    tr:hover { background:#1e293b; cursor:pointer }
    .panel { margin-top:20px; padding:15px; background:#111827; border-radius:8px }
    #file-area { margin-top:10px; margin-bottom:10px }
    #file-input { padding:6px 10px; border-radius:6px; border:1px solid #1f2937; background:#020617; color:#e5e7eb }
    #error-box { color:#f87171; margin-top:8px; min-height:1em; font-size:13px }

    .badge {
      display:inline-block; padding:3px 8px; border-radius:999px;
      font-size:11px; text-transform:uppercase; letter-spacing:0.05em
    }
    .badge-good { background:#064e3b; color:#a7f3d0 }
    .badge-warn { background:#7f1d1d; color:#fecaca }

    .validation-grid { display:flex; flex-wrap:wrap; gap:12px; margin-top:10px; font-size:13px }
    .validation-item { min-width:160px; color:#e5e7eb }
    .validation-label { color:#9ca3af; font-size:12px; text-transform:uppercase }
    .validation-value { margin-top:2px }

    #detail-content { font-size:13px; line-height:1.5 }
    #detail-content h4 { margin:0 0 6px 0; font-size:14px }
    #detail-content .section { margin-top:10px }

    #about-page h2 { margin-top:0; margin-bottom:8px; font-size:20px }
    #about-page h3 { margin-top:14px; margin-bottom:6px; font-size:15px }
    #about-page p { margin:4px 0; font-size:14px; color:#d1d5db; line-height:1.5 }
    #about-page ul { margin:6px 0 6px 18px; padding:0; font-size:14px; color:#d1d5db }
    #about-page li { margin:2px 0 }
    .muted { color:#9ca3af; font-size:13px }
    .strong { font-weight:600 }
  </style>
</head>

<body>
<div class="page">

  <div class="toggle-container">
    <button id="btn-analyst" class="toggle-button active">Analyst</button>
    <button id="btn-management" class="toggle-button">Management</button>
    <button id="btn-about" class="toggle-button">About</button>
  </div>

  <div id="file-area">
    <input id="file-input" type="file" accept=".csv" />
    <div id="error-box"></div>
  </div>

  <div id="analyst-table" class="panel">
    <h3>Analyst Summary</h3>
    <table>
      <thead>
        <tr>
          <th>SKU</th>
          <th>Class</th>
          <th>Periods</th>
          <th>Total Qty</th>
          <th>Avg / Period</th>
          <th>MAPE%</th>
          <th>Forecast</th>
        </tr>
      </thead>
      <tbody id="summary-body"></tbody>
    </table>
  </div>

  <div id="validation-panel" class="panel">
    <h3>Data Validation</h3>
    <div>
      Overall Status:
      <span id="validation-score" class="badge badge-good">Waiting for data</span>
    </div>
    <div id="validation-details" class="validation-grid">
      <div class="validation-item">
        <div class="validation-label">Missing stock entries</div>
        <div class="validation-value" id="val-missing">0</div>
      </div>
      <div class="validation-item">
        <div class="validation-label">Non-chronological dates</div>
        <div class="validation-value" id="val-nonchrono">No</div>
      </div>
      <div class="validation-item">
        <div class="validation-label">Invalid stock values</div>
        <div class="validation-value" id="val-invalid">0</div>
      </div>
      <div class="validation-item">
        <div class="validation-label">Replenishment jumps</div>
        <div class="validation-value" id="val-replenish">0</div>
      </div>
      <div class="validation-item">
        <div class="validation-label">Duplicate SKUs</div>
        <div class="validation-value" id="val-duplicates">None</div>
      </div>
    </div>
  </div>

  <div id="management-table" class="panel hidden">
    <h3>Management Summary</h3>
    <table>
      <thead>
        <tr>
          <th>SKU</th>
          <th>Usage Pattern</th>
          <th>Adj Usage / Working Day</th>
          <th>30 / 60 / 90 Days (Adj)</th>
          <th>Recommendation</th>
        </tr>
      </thead>
      <tbody id="mgmt-body"></tbody>
    </table>
  </div>

  <div id="detail-view" class="panel">
    <h3>Detail View</h3>
    <div id="detail-content">Upload a CSV file and click a SKU.</div>
  </div>

  <div id="about-page" class="panel hidden">
    <h2>About This Demand Forecasting Tool</h2>
    <p>
      This tool helps you understand how inventory is actually being used over time,
      so you can set realistic stock levels and avoid surprises on the shop floor.
    </p>

    <h3>What the tool does</h3>
    <p>
      You upload a simple CSV with SKUs and repeated cycle-count snapshots.
      The tool converts those snapshots into true consumption by looking at how stock
      moves between dates for each item.
    </p>
    <p>
      It then builds a clean time-series for every SKU, classifies usage patterns
      (Active, Low-Movement, Dead), and creates short-horizon forecasts that are easy
      to explain to operations and purchasing teams.
    </p>

    <h3>How demand is calculated</h3>
    <p>
      For each pair of stock counts, the tool calculates:
      <span class="strong">Qty Moved = max(previous stock − current stock, 0)</span>.
    </p>
    <ul>
      <li>If stock goes down, that difference is treated as true usage.</li>
      <li>If stock goes up or stays flat, it is treated as replenishment or no use, and demand is set to zero.</li>
    </ul>
    <p>
      This keeps the focus on what actually left the shelf instead of how much was ordered.
    </p>

    <h3>Rolling usage windows</h3>
    <p>
      The tool looks at usage over the last 30, 60, and 90 calendar days using the actual dates
      in your file, even if counts are weekly or uneven. Each movement is placed into the correct
      window based on its date.
    </p>

    <h3>Working-day normalization</h3>
    <p>
      Not all days are equal. The tool removes weekends and Ontario statutory holidays
      when it calculates working days between counts. It then converts each movement into:
    </p>
    <p class="strong">
      usage per working day = quantity moved ÷ number of working days
    </p>
    <p>
      Analyst Mode shows both raw usage and working-day-adjusted usage.
      Management Mode uses the adjusted version to keep decisions aligned with
      the real production calendar.
    </p>

    <h3>Privacy and data handling</h3>
    <p class="muted">
      • Your data never leaves your browser.<br>
      • There is no server, no login, and no database.<br>
      • Files are read in memory only for the duration of your session.
    </p>

    <h3>How to use it</h3>
    <ul>
      <li>Prepare a CSV with SKU, description, and multiple date columns of stock on hand.</li>
      <li>Upload the file and start in Analyst mode to review data quality and demand patterns.</li>
      <li>Switch to Management mode to see working-day-normalized usage and simple recommendations.</li>
      <li>Use the Detail view to drill into any SKU’s history and rolling-window behaviour.</li>
    </ul>

    <h3>Version and author</h3>
    <p class="muted">
      Version: <span class="strong">v2.0</span><br>
      Author: <span class="strong">Alok Kulkarni</span>
    </p>
  </div>

</div>

<script src="main.js"></script>
</body>
</html>
