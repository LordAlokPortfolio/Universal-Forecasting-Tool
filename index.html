<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Universal Forecasting Tool — v2</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<style>
body{background:#0b1120;color:#e5e7eb;margin:0;font-family:system-ui}
.page{max-width:1400px;margin:auto;padding:20px}
.hidden{display:none}
button{cursor:pointer}

.toggle-container{display:flex;gap:8px;justify-content:flex-end}
.toggle-button{padding:6px 14px;border-radius:18px;border:1px solid #38bdf8;background:none;color:#38bdf8}
.toggle-button.active{background:#38bdf8;color:#0b1120;font-weight:700}

input[type=file]{background:#020617;color:#e5e7eb;border:1px solid #1f2937;padding:6px;border-radius:6px}

.snap-container{height:75vh;overflow-y:auto;scroll-snap-type:y mandatory}
.card{background:#111827;border-radius:12px;padding:16px;margin-bottom:16px;scroll-snap-align:start;border-left:6px solid #374151}
.card-A{border-left-color:#22c55e}
.card-B{border-left-color:#facc15}
.card-C{border-left-color:#64748b}

.card-title{font-size:18px;font-weight:700}
.card-desc{color:#9ca3af;font-size:14px;margin-top:2px}
.card-body{margin-top:10px;line-height:1.45}
.card-footer{margin-top:10px;border-top:1px solid #1f2937;padding-top:8px;font-weight:600}

.inline-edit{background:#020617;border:1px solid #374151;color:#e5e7eb;border-radius:4px;padding:4px}

.about{max-width:900px;line-height:1.6}
.about h3{margin-top:24px}
.muted{color:#9ca3af}

/* Planning window */
.plan-window{display:flex;gap:6px;margin:10px 0}
.plan-btn{padding:4px 10px;border-radius:14px;border:1px solid #334155;background:none;color:#cbd5f5}
.plan-btn.active{background:#334155;font-weight:700}

/* Validation */
.validation{margin-top:10px;padding:10px;border:1px solid #1f2937;border-radius:8px;background:#020617}
</style>
</head>

<body>
<div class="page">

<!-- MODE TOGGLE -->
<div class="toggle-container">
  <button id="btn-analyst" class="toggle-button active">Analyst</button>
  <button id="btn-management" class="toggle-button">Management</button>
  <button id="btn-about" class="toggle-button">About</button>
  <button id="btn-planning" class="toggle-button">Planning</button>
</div>

<!-- FILE INPUTS -->
<div style="margin:10px 0">
  <div>
    <strong>Cycle Count CSV (required)</strong><br>
    <input id="cycle-file" type="file" accept=".csv">
  </div>
  <div style="margin-top:6px">
    <strong>Purchase History CSV (optional)</strong><br>
    <input id="po-file" type="file" accept=".csv">
  </div>
</div>

<!-- PLANNING WINDOW -->
<div class="plan-window">
  <span class="muted">Planning window:</span>
  <button id="btn-win-30" class="plan-btn">30d</button>
  <button id="btn-win-60" class="plan-btn">60d</button>
  <button id="btn-win-90" class="plan-btn active">90d</button>
</div>

<!-- ANALYST -->
<div id="analyst-view">
  <table width="100%" cellspacing="0">
    <thead>
      <tr>
        <th>SKU</th>
        <th>Class</th>
        <th>Avg / WD</th>
        <th>30d</th>
        <th>60d</th>
        <th>90d</th>
      </tr>
    </thead>
    <tbody id="analyst-body"></tbody>
  </table>
</div>
<section id="planning" class="panel hidden">
  <h2>Production Planning (BOM-less)</h2>

  <div class="planning-inputs">
    <label>
      Doors per day
      <input type="number" id="doorsPerDay" value="45" min="1" />
    </label>

    <label>
      Working days per year
      <input type="number" id="workingDays" value="250" min="1" />
    </label>

    <button id="runPlanning">Calculate Material Plan</button>
  </div>

  <table id="materialPlan">
    <thead>
      <tr>
        <th>Material</th>
        <th>Unit</th>
        <th>Expected</th>
        <th>Low</th>
        <th>High</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</section>
<style>
  .planning-inputs {
    display: flex;
    gap: 1rem;
    align-items: flex-end;
    margin-bottom: 1rem;
  }
  #materialPlan th, #materialPlan td {
    padding: 6px 10px;
    text-align: right;
  }
  #materialPlan th:first-child,
  #materialPlan td:first-child {
    text-align: left;
  }
</style>


<!-- MANAGEMENT -->
<div id="management-view" class="hidden">
  <div class="snap-container" id="rolodex"></div>
</div>

<!-- VALIDATION -->
<div id="validation-summary" class="validation muted"></div>

<!-- ABOUT (REPLACE ENTIRE about-view BLOCK IN index.html) -->
<div id="about-view" class="hidden about">
  <h2>About This Tool</h2>
  <p>
    Universal Forecasting Tool is a client-only demand planning application designed
    to demonstrate real-world demand planner thinking using consumption-based data.
  </p>

  <h3>Why it was built</h3>
  <p>
    Most inventory tools mix demand and supply and hide assumptions.
    This tool was built to clearly separate consumption-based demand from supply visibility,
    mirroring how demand planners actually work in manufacturing environments.
  </p>

  <h3>How it works</h3>
  <ul>
    <li>Upload historical cycle counts (required)</li>
    <li>Optionally upload purchase history for supplier and lead-time visibility</li>
    <li>All calculations run entirely in the browser</li>
  </ul>

  <h3>Privacy statement</h3>
  <p>
    No data is stored, transmitted, or logged.
    All files remain local to your browser session and are discarded on refresh.
  </p>

  <h3>Demand forecasting method</h3>
  <p>
    Demand is calculated strictly from stock reductions between cycle counts.
    Usage is normalized by working days (weekends and statutory holidays excluded)
    and evaluated using rolling 30 / 60 / 90-day windows.
  </p>

  <h3>Management mode vs Analyst mode</h3>
  <ul>
    <li><strong>Analyst mode</strong> exposes detailed metrics and adjusted usage calculations</li>
    <li><strong>Management mode</strong> presents decision-focused SKU cards and recommendations</li>
  </ul>

  <h3>Developer credits</h3>
  <p>
    Designed and built by Alok Kulkarni. Intended for practical, real-world use.
  </p>

  <h3>Version info</h3>
  <p class="muted">
    Universal Forecasting Tool — Version 4.0<br>
    Client-only • Consumption-based demand • 0 to 24 month planning horizon
  </p>
</div>


<script src="main.js"></script>

<script>
/* Planning window buttons */
document.getElementById("btn-win-30").onclick=()=>setPlanningWindow(30)
document.getElementById("btn-win-60").onclick=()=>setPlanningWindow(60)
document.getElementById("btn-win-90").onclick=()=>setPlanningWindow(90)
</script>

</body>
</html>
